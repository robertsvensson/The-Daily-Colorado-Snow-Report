<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8"/>
    <title>Rating Dropdown Widget</title>
    <!--
    Include styles from the Contentful app.
    See http://contentful.github.io/ui-extensions-sdk/styleguide for information on
    how to include and apply these styles.
     -->
    <link rel="stylesheet" href="https://contentful.github.io/ui-extensions-sdk/cf-extension.css">
    <style>
     body { margin: 0; }
     #entries { margin-top: 1em; }
     #entries-list { margin-top: 1em; }
     #rating { margin-right: 1em; }
    </style>


    <!--
    Load the Extensions API that is used to communicate with the containing app.
    -->
    <script src="https://contentful.github.io/ui-extensions-sdk/cf-extension-api.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.js"></script>
  </head>
  <body>
    <p>
      <button class="cf-btn-primary" onclick="myFunction()" id="getSnowDepth">Get snow depth</button>
    </p>
    <p>
      <div class="cf-form-field">
        <label>Name</label>
        <input type="text" value="Contentful!" class="cf-form-input" id="COsnowDepth">
        <div class="cf-form-hint">
          You have to provide your name here or there
        </div>
      </div>
    </p>

    <script>
    function myFunction() {
      console.log('I clicked the button');
      var ACCESS_ID ='9xKgBsSEnApnNhGYgrpFp';
      var SECRET_KEY='z9VMTOpFSyWe7hNRn1w3xVHpxUGZO0WPWq9kirKj';
      var API_END_POINT='https://api.aerisapi.com/';

      var req = new XMLHttpRequest();

      req.open("GET",API_END_POINT+'winter/snowdepth/48.41108,-114.33763?client_id='+ ACCESS_ID +'&client_secret='+SECRET_KEY,false);
      req.send(null);

      var obj = JSON.parse(req.response);
      console.log(req.response);
      console.log(obj.response.periods[0].snowDepthIN)
      document.getElementById("COsnowDepth").value = obj.response.periods[0].snowDepthIN;
    }
    </script>



    <script>

      // This is the main entry point for extensions.
      //
      // The extension API reference explains in detail what you can do with
      // the 'api' object.
      var cfExt = window.contentfulExtension || window.contentfulWidget
      cfExt.init(function (api) {
        // Whenever the size of this document changes we adjust the size of
        // the IFrame in the Contentful App.
        api.window.startAutoResizer()
        console.log('Inside the thing');
        alert('sfsd');
        console.log('is this updated eyt');



      })
    </script>
  </body>
</html>
